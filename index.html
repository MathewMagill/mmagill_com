<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chinese Dialogue</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    .quiz-container { background: #fff; padding: 20px; border-radius: 8px; max-width: 500px; margin: auto; }
    .question { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; }
    input[type="text"] { width: 100%; padding: 8px; margin-bottom: 10px; }
    .btn { background: #007bff; color: #fff; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
    .btn:disabled { background: #aaa; }
    .result { margin-top: 20px; font-size: 1.2em; }
    .answers { margin-top: 10px; }
    .correct { color: green; }
    .incorrect { color: red; }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h2>Chinese Dialogue</h2>
    <form id="quiz-form">
      <!-- Questions will be injected here -->
    </form>
    <button class="btn" id="submit-btn">Submit Answers</button>
    <div class="result" id="result"></div>
    <div class="answers" id="answers"></div>
  </div>
  <script>
    // Quiz questions and answers
    const questions = [
      { q: "你好！", a: "你好！" },
      { q: "你吃饱了吗？", a: ["吃饱了。", "我吃饱了。"] },
      { q: "你叫什么名字？", a: null }, // special check
      { q: "你几岁？", a: ["我十三岁。", "我十四岁。"] },
      { q: "你喜欢什么食物？", a: ["我喜欢冰淇淋。", "我喜欢披萨。"] }
    ];

    const quizForm = document.getElementById('quiz-form');
    const submitBtn = document.getElementById('submit-btn');
    const resultDiv = document.getElementById('result');
    const answersDiv = document.getElementById('answers');

    // Render questions
    questions.forEach((item, idx) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <label for="q${idx}">${idx + 1}. ${item.q}</label>
        <input type="text" id="q${idx}" name="q${idx}" autocomplete="off">
      `;
      quizForm.appendChild(div);
    });

    // Special check for Q3: "我叫" + English name + "。"
    function checkThirdAnswer(userAnswer) {
      userAnswer = userAnswer.trim();
      if (!userAnswer.startsWith("我叫") || !userAnswer.endsWith("。")) return false;
      const name = userAnswer.slice(2, -1).trim();
      return /^[A-Za-z\s]+$/.test(name) && name.length > 0;
    }

    submitBtn.addEventListener('click', function(e) {
      e.preventDefault();
      let score = 0;
      let answersHtml = '';
      questions.forEach((item, idx) => {
        const userAnswer = document.getElementById(`q${idx}`).value.trim();
        let correct = false;
        let correctAnswer = "";

        if (idx === 2) {
          correct = checkThirdAnswer(userAnswer);
          correctAnswer = "我叫(Your English name)。";
        } else if (Array.isArray(item.a)) {
          correct = item.a.includes(userAnswer);
          correctAnswer = item.a.join(" 或 ");
        } else {
          correct = userAnswer === item.a;
          correctAnswer = item.a;
        }

        if (correct) score++;
        answersHtml += `
          <div>
            <strong>Q${idx + 1}:</strong> ${item.q}<br>
            Your answer: <span class="${correct ? 'correct' : 'incorrect'}">${userAnswer || '(No answer)'}</span><br>
            Correct answer: <span class="correct">${correctAnswer}</span>
          </div>
          <hr>
        `;
      });
      resultDiv.textContent = `Your score: ${score} / ${questions.length}`;
      answersDiv.innerHTML = answersHtml;
      submitBtn.disabled = true;
    });
  </script>
</body>
</html>
